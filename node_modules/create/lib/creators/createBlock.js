import { z } from "zod";
import { isDefinitionWithOptions } from "./utils";
export function createBlock(blockDefinition) {
    if (!isDefinitionWithOptions(blockDefinition)) {
        return ((context) => {
            return blockDefinition.produce(context);
        });
    }
    const blockSchema = z.object(blockDefinition.options);
    const block = async (context) => {
        return await blockDefinition.produce({
            ...context,
            options: blockSchema.parse(context.options),
        });
    };
    block.createAddon = (addonDefinition) => {
        if (!isDefinitionWithOptions(addonDefinition)) {
            return (context) => {
                return addonDefinition.produce(context);
            };
        }
        const addonSchema = z.object(addonDefinition.options);
        return async (context) => {
            return await addonDefinition.produce({
                ...context,
                options: addonSchema.parse(context.options),
            });
        };
    };
    return block;
}
//# sourceMappingURL=createBlock.js.map